Conflux æ™ºèƒ½åˆçº¦å¼€å‘ä½“éªŒ
===
![](https://confluxnetwork.org/static/logo-w@2-a4802194a8a9b32e5ad6649b9c13cc33.png)

[Conflux](https://confluxnetwork.org/) æ˜¯æ–°ä¸€ä»£é«˜æ€§èƒ½å…¬é“¾ï¼ŒåŸºäºè‡ªç ”çš„TreeGraphè´¦æœ¬ç»“æ„å’ŒGHASTå…±è¯†åè®®ï¼Œèƒ½å¤Ÿåœ¨å®Œå…¨å»ä¸­å¿ƒåŒ–çš„å‰æä¸‹ï¼Œå®ç°3000+TPSçš„ååç‡ã€‚
å¹¶ä¸”å…¶æ™ºèƒ½åˆçº¦VMï¼Œå¯ä»¥å®Œå…¨å…¼å®¹EVMï¼Œæ„å‘³ç€ä»¥å¤ªåŠçš„æ™ºèƒ½åˆçº¦å¯ä»¥ä¸ç”¨æ”¹åŠ¨ç›´æ¥éƒ¨ç½²åˆ°ConfluxåŒºå—é“¾ä¸Šã€‚
ç›®å‰Confluxä¸»ç½‘æ­£åœ¨åˆ†é˜¶æ®µï¼ˆå…±ä¸‰é˜¶æ®µï¼‰ä¸Šçº¿ï¼Œè®¡åˆ’å¹´å†…å®Œæˆæ­£å¼å‘å¸ƒã€‚ç›®å‰å¤„äºç¬¬ä¸€é˜¶æ®µ(Pontus), å°ä¼™ä¼´ä»¬å¯ä»¥æå‰ä½“éªŒConflux é£ä¸€èˆ¬çš„é€Ÿåº¦ã€‚
è¿™é‡ŒæŠŠåœ¨Confluxä¸Šéƒ¨ç½²æ™ºèƒ½åˆçº¦çš„è¿‡ç¨‹å’Œä½“éªŒåšäº†ä¸€ä¸ªç®€å•è®°å½•ã€‚

* [åˆ›å»ºè´¦å·](#åˆ›å»ºConfluxåŒºå—é“¾è´¦å·)
* [è¿è¡Œæœ¬åœ°èŠ‚ç‚¹](#è¿è¡Œæœ¬åœ°èŠ‚ç‚¹)
* [js-sdkå‘é€äº¤æ˜“](#ä½¿ç”¨js-conflux-sdkå‘é€äº¤æ˜“)
* [å¼€å‘&ç¼–è¯‘æ™ºèƒ½åˆçº¦](#å¼€å‘ç¼–è¯‘æ™ºèƒ½åˆçº¦)
* [éƒ¨ç½²](#åˆçº¦éƒ¨ç½²)
* [æ™ºèƒ½åˆçº¦äº¤äº’](#æ™ºèƒ½åˆçº¦äº¤äº’)
* [å‚è€ƒ](#å‚è€ƒèµ„æ–™)

## åˆ›å»ºConfluxåŒºå—é“¾è´¦å·
ä½“éªŒä»»ä½•åŒºå—é“¾ç³»ç»Ÿï¼Œè·å–è´¦å·ï¼ˆåœ°å€ï¼‰æ˜¯ç¬¬ä¸€æ­¥ï¼Œè´¦å·æ˜¯è¿›å…¥åŒºå—é“¾ä¸–ç•Œçš„é—¨ç¥¨æˆ–é’¥åŒ™ã€‚è¿è¡Œå…¨èŠ‚ç‚¹æŒ–çŸ¿ï¼Œéƒ¨ç½²æ™ºèƒ½åˆçº¦ï¼Œè·å–å‘é€æ•°å­—è´§å¸å‡éœ€è¦è´¦å·ã€‚
åŒºå—é“¾é’±åŒ…è½¯ä»¶éƒ½æœ‰åˆ›å»ºè´¦å·çš„åŠŸèƒ½ï¼Œç›®å‰ Conflux å®˜æ–¹æä¾›äº†ä¸¤æ¬¾é’±åŒ… Conflux Portal å’Œ Web walletã€‚


### Conflux Portal
[Conflux Portal](https://portal.conflux-chain.org/) æ˜¯ä¸€ä¸ªæµè§ˆå™¨æ‰©å±•ç¨‹åºï¼Œéœ€è¦åˆ°æµè§ˆå™¨æ‰©å±•å¸‚åœºå®‰è£…ã€‚Portal æ˜¯åœ¨ MetaMask åŸºç¡€ä¹‹ä¸Šä¿®æ”¹ï¼Œå¹¶é€‚é…Confluxç½‘ç»œçš„ï¼Œå…¶ä¸»è¦åŠŸèƒ½å’Œä½¿ç”¨æ–¹å¼è·Ÿ MetaMask åŸºæœ¬ä¸€è‡´ã€‚

å®‰è£…å®Œä¹‹åï¼Œé¦–æ¬¡è¿›å…¥ä¼šçœ‹åˆ°ä¸¤ä¸ªé€‰é¡¹ï¼šåˆ›å»ºæ–°é’±åŒ…æˆ–é€šè¿‡åŠ©è®°è¯å¯¼å…¥ï¼ˆ12 éšæœºå•è¯ï¼Œç”¨äºå¤‡ä»½è´¦æˆ·ï¼‰ã€‚å¦‚æœé€‰æ‹©åˆ›å»ºæ–°é’±åŒ…ï¼Œä¼šéšæœºç”Ÿæˆæ–°çš„åŠ©è®°è¯ï¼Œä½ éœ€è¦ä¿å­˜ä¸‹æ¥ï¼Œå¹¶è®°å¥½ï¼Œå› ä¸ºä¸‹æ­¥ä¼šè¿›è¡Œç¡®è®¤ï¼Œè€Œä¸”åŠ©è®°è¯ä¹Ÿæ˜¯æ¢å¤å’Œè¿ç§»é’±åŒ…çš„å”¯ä¸€æ–¹å¼ã€‚

![](./images/portal-entry.png)

è¿›è¡ŒåŠ©è®°è¯ç¡®è®¤ï¼Œç¡®è®¤ä¹‹åä¼šéœ€è¦è®¾ç½®ä¸€ä¸ªå¯†ç ï¼Œportal ä¼šä¸å®šæœŸé”å®šï¼Œä¹‹åè¿›å…¥éœ€è¦è¾“å…¥å¯†ç ã€‚

![](./images/portal-zhujici-confirm.png)

ä¸€åˆ‡è®¾ç½®å®Œæˆä¹‹åä½ å°±æœ‰ä¸€ä¸ªprotal é’±åŒ…äº†ï¼Œé‡Œé¢å¯ä»¥åˆ›å»ºå¤šä¸ªè´¦æˆ·ï¼ŒæŸ¥çœ‹åœ°å€ç§é’¥ï¼Œæ”¶å‘CFXã€‚

![](./images/portal-main.png)

éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š

1. åŠ©è®°è¯éå¸¸å…³é”®ï¼Œè¦ä¿å­˜å¥½ã€‚
2. å­˜å…¥æŒ‰é’®é‡Œé¢æœ‰ faucetåŠŸèƒ½ï¼Œå¯ä»¥ç”³é¢†æµ‹è¯•ä»£å¸ã€‚
3. è´¦æˆ·è¯¦æƒ…é‡Œé¢å¯ä»¥æŸ¥çœ‹ç§é’¥ã€‚


### (Web) Conflux Wallet
Conflux å®˜æ–¹çš„å¦å¤–ä¸€ä¸ªé’±åŒ…æ˜¯ Web ç‰ˆçš„ walletï¼Œä¸éœ€è¦å®‰è£…ï¼Œç›´æ¥é€šè¿‡[ç½‘å€](https://wallet.confluxscan.io/login)è®¿é—®ã€‚åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ web ç‰ˆ wallet åï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé€‰é¡¹: è¿›å…¥é’±åŒ…ï¼Œåˆ›å»ºæ–°é’±åŒ…ã€‚

![](./images/web-wallet-entry.png)

1. æ–°ç”¨æˆ·é¦–æ¬¡è¿›æ¥åªèƒ½è¿›è¡Œåˆ›å»ºæ–°é’±åŒ…æ“ä½œï¼Œé’±åŒ…åˆ›å»ºé¦–å…ˆéœ€è¦è®¾ç½®å¯†ç ï¼Œè®¾ç½®å®Œæˆä¹‹åï¼Œä¼šæä¾› keystore ä¸‹è½½é“¾æ¥ï¼Œç‚¹å‡»ä¸‹è½½åˆ°æœ¬åœ°ã€‚
2. è€ç”¨æˆ·å¯é€‰æ‹©è¿›å…¥é’±åŒ…ï¼Œç¬¬ä¸€æ­¥ä¼šæç¤ºä¸Šä¼  keystore æ–‡ä»¶ï¼Œç„¶åè¾“å…¥å¯†ç ï¼ŒæˆåŠŸä¹‹åä¼šè¿›å…¥web wallet çš„ä¸»é¡µé¢ã€‚

![](./images/web-wallet-home.jpg)

è¯¥é¡µé¢ä¸»è¦æä¾›çš„åŠŸèƒ½æœ‰ï¼š
1. è´¦æˆ·åœ°å€ï¼ˆå¯ç‚¹å‡»å¤åˆ¶æˆ–æŸ¥çœ‹äºŒç»´ç ï¼‰ï¼Œä¸‹è¾¹æä¾›äº†ç§é’¥æŸ¥çœ‹çš„å›¾æ ‡
2. CFXèµ„äº§ç®¡ç†åŠŸèƒ½ï¼Œå¯æŸ¥çœ‹ä½™é¢ï¼Œæ”¶å‘CFX
3. FansCoinï¼ˆç¤¾åŒºå¸ï¼‰ç®¡ç†åŠŸèƒ½
4. ç½‘ç»œåˆ‡æ¢ï¼ˆweb wallet ç›®å‰åªæ”¯æŒPontusä¸»ç½‘ï¼‰
5. Conflux æµè§ˆå™¨é“¾æ¥
6. Pontus ä»£å¸ç”³é¢†é“¾æ¥ï¼Œæ¯å°æ—¶å¯é¢†ä¸€æ¬¡ï¼ˆä¸´æ—¶ä¸»ç½‘CFXï¼Œä¹‹åä¸»ç½‘é‡å¯ï¼Œè¯¥ä»£å¸å¤±æ•ˆï¼‰

éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š
1. åˆ›å»ºè´¦å·çš„å¯†ç å’Œkeystoreæ–‡ä»¶ä¸€å®šè¦å¦¥å–„ä¿ç®¡ï¼Œæœ‰è¿™ä¸¤è€…æ‰èƒ½è¿›å…¥é’±åŒ…ï¼Œå¦‚æœè¢«åˆ«äººè·å–ä¼šé€ æˆèµ„äº§è¢«ç›—
2. è´¦å·çš„ç§é’¥éå¸¸é‡è¦ï¼Œä¸èƒ½éšæ„æ³„éœ²
3. ç§é’¥å’Œ keystore å‡åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä¸ä¼šä¸Šä¼ åˆ° Conflux æœåŠ¡å™¨ã€‚


é€šè¿‡ web wallet å’Œ conflux portalå‡å¯ä»¥åˆ›å»ºè´¦å·ï¼Œè·å–åœ°å€å’Œç§é’¥, åœ°å€é€šå¸¸ä»¥ 0xå¼€å¤´ï¼Œä¾‹å¦‚ ```0x10c410e4ed1977cf7f963cdcc8888e65e2d8a9a4```,
è´¦å·å’Œç§é’¥åœ¨éƒ¨ç½²åˆçº¦çš„æ—¶å€™éƒ½ä¼šç”¨åˆ°ã€‚


## è¿è¡Œæœ¬åœ°èŠ‚ç‚¹
Pontus ç›®å‰è¿è¡Œçš„æ˜¯ Rust å¼€å‘çš„ Conflux [åè®®å®ç°](https://github.com/Conflux-Chain/conflux-rust)ï¼Œè¿è¡Œæœ¬åœ°èŠ‚ç‚¹å¯ä»¥ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„èŠ‚ç‚¹ç¨‹åºæˆ–
ä¸‹è½½æºç æœ¬åœ°ç¼–è¯‘ã€‚ä¸ºäº†å®Œæ•´ä½“éªŒï¼Œè¿™é‡Œé‡‡ç”¨ä¸‹è½½æºç è¿›è¡Œç¼–è¯‘çš„æ–¹å¼ã€‚ï¼ˆç¼–è¯‘ç¯å¢ƒä¸º OSXï¼‰ã€‚

### å‡†å¤‡ç¼–è¯‘ç¯å¢ƒ
ç¼–è¯‘å‰éœ€è¦å…ˆå‡†å¤‡ç¯å¢ƒï¼Œå®‰è£…å¿…é¡»çš„è½¯ä»¶ï¼šRust, cmake, clang ç­‰

1. åœ¨ OSX ä¸­å¼€å‘ï¼Œå…ˆå®‰è£… xcode command line ä¸€å®šæ²¡é”™ï¼Œå¯ä»¥ç›´æ¥åœ¨App storeå®‰è£…Xcodeï¼ˆåŒ…å«command line å·¥å…·ï¼‰ï¼Œæˆ–ç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤```xcode-select --install```å®‰è£… (å…·ä½“å®‰è£…æ­¥éª¤å¯è‡ªè¡ŒGoogle)
2. é€šè¿‡ rustup å®‰è£… Rust è¯­è¨€ç¯å¢ƒ 
    ```sh
    $ curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
    ```
3. å®‰è£…brew ï¼ˆOSX ä¸‹çš„åŒ…ç®¡ç†è½¯ä»¶-ç¥å™¨ï¼‰
    ```sh
    $ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
    ```
4. å®‰è£… cmake (conflux-rust ç¼–è¯‘å›ç”¨åˆ°ï¼‰ ```brew install cmake```
5. clang (xcode command line åŒ…å«ï¼Œä¸éœ€è¦å•ç‹¬å®‰è£…ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡brew å®‰è£… ```brew install llvm```)

å…¶ä»–æ“ä½œç³»ç»Ÿçš„ç¯å¢ƒå‡†å¤‡æ–¹å¼å¯ä»¥å‚çœ‹å®˜æ–¹çš„[æ–‡æ¡£](https://developer.conflux-chain.org/docs/conflux-doc/docs/installation)

### ç¼–è¯‘ä»£ç 
Conflux æ˜¯å¼€æºé¡¹ç›®ï¼Œä»£ç åœ¨ Github ä¸Šå¼€æºï¼Œå¯é€šè¿‡ Git clone åˆ°æœ¬åœ°ï¼Œç„¶åè¿›è¡Œç¼–è¯‘ã€‚

```sh
# download Conflux code
$ git clone https://github.com/Conflux-Chain/conflux-rust
$ cd conflux-rust
$ git checkout v0.5.0.4
# build in release mode
$ cargo build --release
```

ç›®å‰çš„ conflux-rust çš„ç‰ˆæœ¬å·æ˜¯ 0.5.0.4 clone ä»£ç å’Œç¼–è¯‘çš„è¿‡ç¨‹æ—¶é—´æ¯”è¾ƒé•¿ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ğŸ¤“ï¼ˆè·Ÿæ®ç½‘ç»œæƒ…å†µï¼Œä¸ä¸€è€ŒåŒï¼‰ã€‚
ç¼–è¯‘ç»“æŸä¹‹åï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ target/releaseï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ª conflux å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³æ˜¯æˆ‘ä»¬æœ€ç»ˆè¦è¿è¡Œçš„æœ¬åœ°èŠ‚ç‚¹ç¨‹åºäº†ã€‚

### è¿è¡Œæœ¬åœ°èŠ‚ç‚¹
è¿è¡ŒèŠ‚ç‚¹æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨ä»£ç  run ç›®å½•ä¸‹çš„ default.toml (tomlæ ¼å¼æ–‡ä»¶) æ˜¯é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•é…ç½®å‡ é¡¹å³å¯ç”¨äºè¿è¡ŒèŠ‚ç‚¹ã€‚

1. ```public_address="124.193.101.50:32323"``` èŠ‚ç‚¹å¯¹å¤–çš„åœ°å€ï¼Œç”±IPï¼ˆå…¬ç½‘IPï¼Œå¯ä»¥é€šè¿‡Googleæˆ–ç™¾åº¦æœç´¢IPè·å¾—ï¼‰å’Œç«¯å£å·ï¼ˆé»˜è®¤32323ï¼‰ç»„æˆ
2. ```mining_author=1386b4185a223ef49592233b69291bbe5a80c527``` æŒ–çŸ¿å¥–åŠ±ç›®æ ‡è´¦å·ï¼Œä¹‹å‰åˆ›å»ºçš„è´¦å·å¯ä»¥å¡«åˆ°è¿™é‡Œï¼ˆæ³¨æ„å»æ‰åœ°å€å‰è¾¹çš„0xï¼Œä¸ç„¶å¯åŠ¨ä¼šæŠ¥é”™ï¼‰
3. ```bootnodes``` æ­¤é¡¹æ˜¯ç”¨äºåŒæ­¥æ•°æ®çš„å¯åŠ¨èŠ‚ç‚¹åœ°å€é…ç½®ï¼Œç‰ˆæœ¬ 0.5.0.4 é»˜è®¤é…ç½®çš„æ˜¯ä¸»ç½‘ Pontus çš„èŠ‚ç‚¹ï¼Œå¯ä»¥ä¸ç”¨ä¿®æ”¹
4. ```start_mining=true``` å¦‚æœæƒ³å¼€å¯æŒ–çŸ¿ï¼Œæ‰“å¼€æ³¨é‡Šï¼Œå¹¶è®¾ç½®ä¸ºtrue 
5. ```jsonrpc_local_http_port=12539``` æœ¬åœ° rpc ç«¯å£é…ç½®ï¼Œæ‰“å¼€æ³¨é‡Šï¼Œå³å¯è®¿é—®æœ¬åœ°rpcæœåŠ¡

è®¾ç½®å¥½ä¹‹åï¼Œå°±å¯ä»¥å¯åŠ¨èŠ‚ç‚¹äº†
```sh
$ cd run
$ ../target/release/conflux --config default.toml
```

å¦‚æœä¸€åˆ‡æ­£å¸¸çš„è¯ï¼Œç¨‹åºä¼šå°è¯•è¿æ¥ç½‘ç»œä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶å¼€å§‹åŒæ­¥åŒºå—æ•°æ®ï¼Œä½ ä¼šçœ‹åˆ° latest_epoch æ•°å­—ï¼Œä¸åœå¢é•¿ï¼Œè¿½èµ¶ä¸»ç½‘ã€‚

![](./images/local-node-syncing.png)


## ä½¿ç”¨js-conflux-sdkå‘é€äº¤æ˜“
Conflux ä¸ä»…æä¾›æ ‡å‡†çš„ JSON-RPC 2.0 æ¥å£ç”¨äºè·Ÿé“¾è¿›è¡Œäº¤äº’ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†å¤šä¸ªè¯­è¨€çš„SDKï¼Œæ–¹ä¾¿å¿«é€Ÿå¼€å‘å’Œé›†æˆï¼ŒåŒ…æ‹¬JavaScriptï¼ŒJavaï¼ŒGoç­‰ã€‚å…¶ä¸­ JS ç‰ˆåŠŸèƒ½æœ€å®Œå–„ã€‚
å¦‚æœä½ è¿›è¡Œè¿‡ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦å¼€å‘ï¼Œå¯ä»¥æŠŠå®ƒç†è§£æˆ web3.jsã€‚è¿™é‡Œæˆ‘ä»¬å°è¯•ç”¨å®ƒå‘é€ä¸€ç¬” CFX è½¬è´¦ï¼ˆNode.js ç¯å¢ƒï¼‰ã€‚é¦–å…ˆä½¿ç”¨ npm å®‰è£…ã€‚

```npm install js-conflux-sdk```

å®‰è£…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒå‘é€ä¸€ç¬” CFX äº¤æ˜“äº†ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```js
// sendTx.js
const { Conflux, util } = require('js-conflux-sdk');

async function main() {
  const TestNetUrl = 'http://testnet-jsonrpc.conflux-chain.org:12537';
  // initiate a Conflux object
  const cfx = new Conflux({
    url: TestNetUrl,
    defaultGasPrice: 100, // The default gas price of your following transactions
    defaultGas: 1000000, // The default gas of your following transactions
    logger: console,
  });

  // account private key
  const PRIVATE_KEY = '0xxxxxxxxxxxx';  // replace your private key here, add 0x prefix
  const account = cfx.Account(PRIVATE_KEY); // create account instance
  const receiver = '0x13d2bA4eD43542e7c54fbB6c5fCCb9f269C1f94C';
  // transaction parameters
  let txParams = {
      from: account, // from account instance and will by sign by account.privateKey
      to: receiver, // accept address string or account instance
      value: util.unit.fromCFXToDrip(0.125), // use unit to transfer from 0.125 CFX to Drip
  };
  // send transaction
  const txHash = await cfx.sendTransaction(txParams);
  console.log(txHash);
}
  
main().catch(e => console.error(e));
```
åœ¨ç»ˆç«¯è¿è¡Œä»¥ä¸Šè„šæœ¬å³å¯å®Œæˆä¸€ç¬”è½¬è´¦ï¼Œæœ€åä¼šè¾“å‡ºä¸€ä¸ªäº¤æ˜“ hashï¼Œä½ å¯ä»¥åˆ° confluxscan æŸ¥è¯¢è¯¥äº¤æ˜“çš„è¯¦ç»†ä¿¡æ¯ã€‚

éœ€è¦æ³¨æ„çš„å‡ ä¸ªåœ°æ–¹ï¼š

1. ç¤ºä¾‹ä¸­ä½¿ç”¨çš„æ˜¯Conflux Testnet çš„ rpc æœåŠ¡
2. ç§é’¥éœ€è¦ä»¥ 0x å¼€å¤´ï¼Œä»é’±åŒ…ä¸­è·å–åˆ°çš„ç§é’¥æ˜¯ä¸åŒ…å« 0x çš„
3. ç¤ºä¾‹ä»£ç å¯ä»¥åœ¨ node.js ç¯å¢ƒä¸­è¿è¡Œï¼Œå…·ä½“å‚çœ‹ sendTx.js
4. å…·ä½“ä½¿ç”¨æ–¹æ³•å‚çœ‹[å®˜æ–¹æ–‡æ¡£](https://developer.conflux-chain.org/docs/conflux-doc/docs/send_transaction)å’Œ[æºç ](https://github.com/Conflux-Chain/js-conflux-sdk)

## å¼€å‘ç¼–è¯‘æ™ºèƒ½åˆçº¦
Conflux å‡ ä¹å®Œå…¨å…¼å®¹ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ï¼Œä»¥å¤ªåŠçš„æ™ºèƒ½åˆçº¦é€šå¸¸æƒ…å†µå¯ä»¥ä¸ç»ä¿®æ”¹ç›´æ¥éƒ¨ç½²åˆ° Conflux ç½‘ç»œï¼Œæœ¬æ–‡ä¸»è¦æ¼”ç¤º Conflux çš„ Dapp éƒ¨ç½²è¿‡ç¨‹å’Œæ–¹å¼ï¼Œå…³äºæ™ºèƒ½åˆçº¦çš„å¼€å‘å’Œæ–‡æ¡£å¯ä»¥æŸ¥çœ‹ä»¥å¤ªåŠç›¸å…³æ–‡æ¡£ã€‚

### Coin æ™ºèƒ½åˆçº¦
```Coin``` æ˜¯ä¸€ä¸ªç®€å•çš„ solidity æ™ºèƒ½åˆçº¦ã€‚å…·å¤‡ä»£å¸çš„åŸºæœ¬åŠŸèƒ½ï¼š

1. mint: é“¸é€ æ–°å¸ (åªæœ‰åˆçº¦å‘å¸ƒè€…å¯ä»¥ mint)
2. balances: æŸ¥è¯¢ä½™é¢
3. send: è½¬è´¦

å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```js
pragma solidity >=0.5.0 <0.7.0;

contract Coin {
    address public minter;
    mapping (address => uint) public balances;

    event Sent(address from, address to, uint amount);

    constructor() public {
        minter = msg.sender;
    }

    function mint(address receiver, uint amount) public {
        require(msg.sender == minter);
        require(amount < 1e60);
        balances[receiver] += amount;
    }

    function send(address receiver, uint amount) public {
        require(amount <= balances[msg.sender], "Insufficient balance.");
        balances[msg.sender] -= amount;
        balances[receiver] += amount;
        emit Sent(msg.sender, receiver, amount);
    }
}
```

Solidity æ˜¯æ™ºèƒ½åˆçº¦å¼€å‘çš„é«˜çº§è¯­è¨€ï¼Œä¸èƒ½ç›´æ¥éƒ¨ç½²ï¼Œéœ€è¦ä½¿ç”¨ç¼–è¯‘å™¨ï¼Œç¼–è¯‘ä¸º bytecodeã€‚ä»¥å¤ªåŠç¤¾åŒºå¼€å‘å·¥å…·ä¼—å¤šï¼ŒåŸç”Ÿ solc(c++) ç¼–è¯‘å™¨ï¼Œ remixï¼Œtruffleï¼Œ Ethereum studio å‡å¯ç”¨æ¥ç¼–è¯‘ï¼Œä¸‹è¾¹æˆ‘ä»¬ä¼šä½¿ç”¨çŸ¥åçš„ Remix åœ¨çº¿ IDE æ¥ç¼–è¯‘ Coin åˆçº¦ã€‚

### ä½¿ç”¨ Remix ç¼–è¯‘
[Remix](https://remix.ethereum.org/)æ˜¯ä¸€ä¸ªä»¥å¤ªåŠæ™ºèƒ½åˆçº¦åœ¨çº¿IDEï¼Œæä¾›æ™ºèƒ½åˆçº¦å¼€å‘ï¼Œæµ‹è¯•ï¼Œç¼–è¯‘ï¼Œéƒ¨ç½²ç­‰åŠŸèƒ½ï¼Œæœ¬æ–‡ä½¿ç”¨ Remix æ¥ç¼–è¯‘ coin æ™ºèƒ½åˆçº¦ã€‚
æ‰“å¼€ remix ç½‘å€ä¹‹åæˆ‘ä»¬ä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢

![](./images/remix-home.jpg)

1. Icon panel å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œç¼–è¾‘ï¼Œç¼–è¯‘ç­‰ä¸»åŠŸèƒ½åˆ‡æ¢
2. Side panel ç‚¹å‡»åŠ å·å¯ä»¥æ·»åŠ æ–‡ä»¶ï¼Œç„¶åæŠŠæˆ‘ä»¬çš„ coin.sol ä»£ç å¤åˆ¶è¿›æ¥
3. å…·ä½“çš„æ–‡ä»¶åˆ—è¡¨
4. Remixæ”¯æŒ solidity å’Œ vyper ä¸¤ç§åˆçº¦å¼€å‘è¯­è¨€ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆé€‰æ‹© solidity ç¯å¢ƒï¼ˆé‡è¦ï¼‰
5. æ§åˆ¶å°ï¼šä¼šæ˜¾ç¤ºç¼–è¯‘ï¼Œéƒ¨ç½²ç­‰æ—¥å¿—ä¿¡æ¯ï¼Œè°ƒè¯•çš„æ—¶å€™å›éå¸¸æœ‰ç”¨ã€‚

æ–‡ä»¶åˆ›å»ºå¥½ï¼Œå¹¶æŠŠcoinåˆçº¦ä»£ç å¤åˆ¶è¿›æ¥ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç¼–è¯‘äº†

![](./images/remix-compile.jpg)

1. é¦–å…ˆåœ¨Icon panelé€‰æ‹©ç¬¬äºŒé¡¹ï¼Œç¼–è¯‘åŠŸèƒ½
2. å¯ä»¥åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ç¼–è¯‘å™¨ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬
3. ç‚¹å‡»compile coin.sol è¿›è¡Œç¼–è¯‘ï¼ˆéœ€è¦å…ˆé€‰ä¸­ coin.solï¼‰
4. ç¼–è¯‘æˆåŠŸä¹‹åå¯ä»¥çœ‹åˆ° abi å’Œ bytecode çš„ä¸‹è½½æŒ‰é’®ï¼Œéœ€è¦æŠŠä¸¤ä¸ªä¸‹æ¥ä¸‹æ¥ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ã€‚

è‡³æ­¤æˆ‘ä»¬ä½¿ç”¨ Remix ç¼–è¯‘äº† Coin åˆçº¦ï¼Œæ‹¿åˆ°äº† abi å’Œ bytecodeï¼Œè¿™ä¸¤ä¸ªæ˜¯æˆ‘ä»¬éƒ¨ç½²åˆçº¦æ—¶ä¼šç”¨åˆ°çš„åŸæ–™ã€‚
å…¶å®å®ƒçš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥è‡ªå·±æ¢ç´¢ã€‚

## åˆçº¦éƒ¨ç½²
åˆçº¦ç¼–è¯‘å¥½ï¼Œç»ˆäºå¯ä»¥è¿›è¡Œéƒ¨ç½²æ“ä½œäº†ï¼Œå¦‚æœå‰å‡ æ­¥ä½ éƒ½æ“ä½œæˆåŠŸçš„è¯ï¼Œä½ ç°åœ¨åº”è¯¥æœ‰ä¸€ä¸ªConflux çš„è´¦å·å’Œç§é’¥ï¼Œé€šè¿‡Facuet é¢†å–äº†ä¸€äº›CFXå¸ï¼Œæœ‰æ™ºèƒ½åˆçº¦çš„ abi å’Œ bytecodeã€‚
å¹¶ä¸”ä½ è¿˜ä¼šä½¿ç”¨ js-conflux-sdk, å¥½æˆ‘ä»¬ç°åœ¨æ¥å°†åˆçº¦éƒ¨ç½²åˆ°confluxç½‘ç»œã€‚åˆçº¦éƒ¨ç½²æœ¬è´¨ä¹Ÿæ˜¯å‘é€äº†ä¸€ç¬” transactionï¼Œåªæ˜¯ä¼šé™„å¸¦ä¸Šåˆçº¦çš„ abi å’Œ bytecodeã€‚
ä¸‹è¾¹æ˜¯ä¸€ä¸ªä½¿ç”¨ js sdk éƒ¨ç½²åˆçº¦çš„è„šæœ¬ï¼š

```js
const { Conflux } = require('js-conflux-sdk');
const MAIN_PRIVATE_KEY = '0xxxxxxxxxx';
const testNetUrl = 'http://testnet-jsonrpc.conflux-chain.org:12537'

async function main() {
  const cfx = new Conflux({
    url: testNetUrl,
    defaultGasPrice: 100,
    defaultGas: 1000000,
    logger: console,
  });

  const account = cfx.Account(MAIN_PRIVATE_KEY); // create account instance
  console.log(account.address);

  // ================================ Contract ================================
  // create contract instance
  const contract = cfx.Contract({
    abi: require('./contracts/coin.abi.json'),
    bytecode: require('./contracts/coin.bin.json'),
  });

  // deploy the contract, and get `contractCreated`
  const receipt = await contract.constructor()
    .sendTransaction({ from: account })
    .confirmed();
  console.log(receipt); 
}

main().catch(e => console.error(e));
```
è®¾ç½®å¥½ç§é’¥ï¼Œé€šè¿‡ node æ‰§è¡Œè¯¥è„šæœ¬ï¼Œå³å¯å®Œæˆæ™ºèƒ½åˆçº¦çš„éƒ¨ç½²ã€‚

éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š
1. coin.bin.json æ–‡ä»¶ä¸­åŒ…å«ä» Remix å¤åˆ¶å‡ºæ¥çš„ bytecode æ•°æ®çš„ object ä¿¡æ¯ï¼Œå¹¶ä¸”éœ€è¦æ·»åŠ  0x å‰ç¼€ï¼Œå¹¶ç”¨åŒå¼•å·å¼•èµ·æ¥æ‰èƒ½é€šè¿‡requireçš„æ–¹å¼åŠ è½½è¿›æ¥ ï¼ˆæˆ–è€…ç›´æ¥å°†object æ”¾åˆ°ä»£ç ä¸­ä¹Ÿå¯ä»¥ï¼‰
2. confirmed() æ–¹å¼è°ƒç”¨ä¼šå®šæ—¶è¯·æ±‚ conflux ç½‘ç»œï¼Œç›´åˆ°äº¤æ˜“è¢«ç¡®è®¤ã€‚
3. åˆçº¦åˆ›å»ºæˆåŠŸå receipt ä¸­ä¼šåŒ…å«äº¤æ˜“çš„ hashï¼Œåˆçº¦çš„åœ°å€ç­‰ä¿¡æ¯ï¼Œå¯ä»¥åˆ° confluxscan ä¸­æŸ¥çœ‹è¯¦æƒ…ã€‚
4. ä¹Ÿå¯ä»¥ä½¿ç”¨ confluxscan çš„[åˆçº¦éƒ¨ç½²é¡µé¢](http://www.confluxscan.io/contract/create)è¿›è¡Œéƒ¨ç½²

## æ™ºèƒ½åˆçº¦äº¤äº’
æ™ºèƒ½åˆçº¦éƒ¨ç½²å®Œæˆä¹‹åæˆ‘ä»¬å°±å¤§åŠŸå‘Šæˆäº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥ç©ä¸€ç©æˆ‘ä»¬çš„åˆçº¦å§ï¼Œè·Ÿåˆçº¦äº¤äº’ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼šè·å–åˆçº¦çŠ¶æ€ï¼ˆè·å–ä½™é¢ï¼‰ï¼›æ›´æ”¹åˆçº¦çŠ¶æ€ï¼ˆè½¬è´¦äº¤æ˜“ï¼‰ã€‚å‰è€…ä¸ä¼šæ¶ˆè€—ä»£å¸ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼›æ”¹å˜åˆçº¦çŠ¶æ€åˆ™éœ€è¦é€šè¿‡å‘é€äº¤æ˜“çš„æ–¹å¼è§¦å‘ï¼Œéœ€è¦èŠ±è´¹ä¸€äº›ä»£å¸ï¼Œå¹¶ä¸”æ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œä¸ä¼šç«‹åˆ»å¾—åˆ°ç»“æœï¼Œåªèƒ½å¾—åˆ°ä¸€ä¸ªäº¤æ˜“çš„hashã€‚ä»¥ä¸‹è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•è¿›è¡Œè¿™ä¸¤ç§åˆçº¦äº¤äº’ã€‚

```js
// invoke-contract.js
const { Conflux, util } = require('js-conflux-sdk');

async function main() {
const PRIVATE_KEY = '0xxxxxxx';
  const cfx = new Conflux({
    url: 'http://testnet-jsonrpc.conflux-chain.org:12537',
    defaultGasPrice: 100,
    defaultGas: 1000000,
    logger: console,
  });

  const account = cfx.Account(PRIVATE_KEY); // create account instance

  const contractAddress = '0x8a43514200778e9ff023039b55ca3192064f8e44';
  const contract = cfx.Contract({
    abi: require('./contracts/coin.abi.json'),
    address: contractAddress,
  });

  let address = '0x1386B4185A223EF49592233b69291bbe5a80C527';

  let ret;
  // mint 100 to address, need send a transaction
  ret = await contract.mint(address, 100).sendTransaction({
      from: account,
  }).confirmed();
  console.log(ret.toString());

  // get balance of address
  ret = await contract.balances(address); 
  console.log(ret.toString());
}

main().catch(e => console.error(e));
```

## æ€»ç»“
å› ä¸ºconfluxä¸»ç½‘åˆšåˆšä¸Šçº¿ï¼Œç›¸å…³æ–‡æ¡£è¿˜åœ¨ä¸æ–­å®Œå–„å½“ä¸­ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠæ•´ä¸ªçš„æ“ä½œè¿‡ç¨‹å±•ç¤ºäº†ä¸€ä¸‹ï¼Œconflux èƒ½å¤Ÿå¾ˆå¥½çš„å…¼å®¹ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ï¼Œæ‰€ä»¥åˆçº¦çš„å¼€å‘å’Œç¼–è¯‘ç”Ÿæ€å¯ä»¥ç›´æ¥å¤ç”¨ä»¥å¤ªåŠ
ï¼Œæ—¢ä¸åŒå­¦ä¹ æ–°çš„åˆçº¦å¼€å‘è¯­è¨€ï¼Œç›¸å…³çš„å·¥å…·ä¹Ÿèƒ½æ‹¿æ¥ç›´æ¥ç”¨ã€‚æ•´ä¸ªä½“éªŒè¿‡ç¨‹ä¸­confluxäº¤æ˜“é€Ÿåº¦çš„ç¡®æ¯”ä»¥å¤ªåŠå¿«å¾ˆå¤šï¼Œè¿˜æ˜¯ç›¸å½“ä»¤äººæƒŠè‰³ã€‚å¸Œæœ› conflux çš„å¼€å‘ç”Ÿæ€å’Œç”¨æˆ·èƒ½å¤Ÿå¾ˆå¿«ç¹è£èµ·æ¥ã€‚

## å‚è€ƒèµ„æ–™

1. [Conflux doc](https://developer.conflux-chain.org/)
2. [Conflux åŒºå—æµè§ˆå™¨ confluxscan](http://www.confluxscan.io/)